name: mir-kiosk
version: 1.2.3 # The miral release version
summary: A minimal Mir based shell for kiosk type applications
description: A minimal Mir based shell for kiosk type applications
confinement: strict
grade: devel

plugs:
  mir-libs:
    interface: content
    content: mir0
    target: mir-libs
    default-provider: mir-libs

apps:
  mir-kiosk:
    command: bin/run-miral
    daemon: simple
    slots: [mir]
    plugs:
      - opengl
      - mir-libs

parts:
  miral-examples:
    plugin: cmake
    source: lp:miral/release
    configflags:
      - -DCMAKE_INSTALL_PREFIX=/usr
    build-attributes:
      - no-system-libraries
    build-packages:
      - build-essential
      - libfreetype6-dev
      - libgles2-mesa-dev
      - libglib2.0-dev
      - libmirserver-dev
      - libmirclient-dev
      - pkg-config
      - python-pil
    stage-packages:
      - libboost-filesystem1.58.0
      - libboost-program-options1.58.0
      - libboost-system1.58.0
      - libegl1-mesa
      - libfreetype6
      - libgles2-mesa
      - libglib2.0-0
      - libnettle6
      - libprotobuf-lite9v5
      - libxkbcommon0
    prime:
      - usr/lib
      - -usr/lib/*/libmir* #Use the libraries from mir-libs content plug
      - usr/bin/miral-kiosk
      - usr/bin/miral-shell
      - usr/share/X11/xkb

  icons:
    plugin: nil
    stage-packages: [dmz-cursor-theme]
    organize:
      usr/share/icons/DMZ-White: icons/default
    prime:
     - icons/default

  glue:
    plugin: dump
    source: glue
